/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 15.0 		*/
/*  Created On : 29-ene.-2023 19:27:11 				*/
/*  DBMS       : SQL Server 2012 						*/
/* ---------------------------------------------------- */

/* Drop Foreign Key Constraints */

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Articulo_Tipoarticulo]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Articulo] DROP CONSTRAINT [FK_Articulo_Tipoarticulo]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Bodega_Escuela]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Bodega] DROP CONSTRAINT [FK_Bodega_Escuela]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Escuela_Capital]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Escuela] DROP CONSTRAINT [FK_Escuela_Capital]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Inventario_Articulo]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Inventario] DROP CONSTRAINT [FK_Inventario_Articulo]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Inventario_Bodega]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Inventario] DROP CONSTRAINT [FK_Inventario_Bodega]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Usuario_Rol]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Usuario] DROP CONSTRAINT [FK_Usuario_Rol]
GO

/* Drop Tables */

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Articulo]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Articulo]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Bodega]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Bodega]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Escuela]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Escuela]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Inventario]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Inventario]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Rol]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Rol]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Tipoarticulo]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Tipoarticulo]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Usuario]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Usuario]
GO

/* Create Tables */

CREATE TABLE [Articulo]
(
	[ArticuloID] int NOT NULL IDENTITY (1, 1),
	[TipoarticuloID] int NOT NULL,
	[Nombre] nvarchar(50) NOT NULL,
	[Descripcion] nvarchar(100) NOT NULL,
	[Marca] nvarchar(50) NOT NULL,
	[Fecha_ingreso] datetime NOT NULL,
	[Precio] float NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Bodega]
(
	[BodegaID] int NOT NULL IDENTITY (1, 1),
	[EscuelaID] int NOT NULL,
	[Nombre] nvarchar(50) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Escuela]
(
	[EscuelaID] int NOT NULL IDENTITY (1, 1),
	[Nombre] nvarchar(100) NOT NULL,
	[Direccion] varchar(200) NOT NULL,
	[Telefono] varchar(20) NOT NULL,
	[Email] varchar(100) NOT NULL,
	[Fecha_fundacion] date NOT NULL,
	[Hora_abierto] datetime NOT NULL,
	[Hora_cerrado] datetime NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Inventario]
(
	[InventarioID] int NOT NULL IDENTITY (1, 1),
	[BodegaID] int NOT NULL,
	[ArticuloID] int NOT NULL,
	[Cantidad_inicial] int NOT NULL,
	[Movimientos_positivos] int NOT NULL,
	[Movimientos_negativos] int NOT NULL,
	[Fecha] date NOT NULL,
	[Saldo_total] int NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Rol]
(
	[RolID] int NOT NULL IDENTITY (1, 1),
	[Rol] nvarchar(50) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Tipoarticulo]
(
	[TipoarticuloID] int NOT NULL IDENTITY (1, 1),
	[Nombre] nvarchar(50) NOT NULL,
	[Descripcion] nvarchar(100) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Usuario]
(
	[UsuarioID] int NOT NULL IDENTITY (1, 1),
	[RolID] int NOT NULL,
	[Username] nvarchar(50) NOT NULL,
	[Clave] nvarchar(50) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE [Articulo] 
 ADD CONSTRAINT [PK_Articulo]
	PRIMARY KEY CLUSTERED ([ArticuloID] ASC)
GO

ALTER TABLE [Bodega] 
 ADD CONSTRAINT [PK_Bodega]
	PRIMARY KEY CLUSTERED ([BodegaID] ASC)
GO

ALTER TABLE [Escuela] 
 ADD CONSTRAINT [PK_Escuela]
	PRIMARY KEY CLUSTERED ([EscuelaID] ASC)
GO

ALTER TABLE [Inventario] 
 ADD CONSTRAINT [PK_Inventario]
	PRIMARY KEY CLUSTERED ([InventarioID] ASC)
GO

ALTER TABLE [Rol] 
 ADD CONSTRAINT [PK_Rol]
	PRIMARY KEY CLUSTERED ([RolID] ASC)
GO

ALTER TABLE [Tipoarticulo] 
 ADD CONSTRAINT [PK_Tipoarticulo]
	PRIMARY KEY CLUSTERED ([TipoarticuloID] ASC)
GO

ALTER TABLE [Usuario] 
 ADD CONSTRAINT [PK_Usuario]
	PRIMARY KEY CLUSTERED ([UsuarioID] ASC)
GO

/* Create Foreign Key Constraints */

ALTER TABLE [Articulo] ADD CONSTRAINT [FK_Articulo_Tipoarticulo]
	FOREIGN KEY ([TipoarticuloID]) REFERENCES [Tipoarticulo] ([TipoarticuloID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Bodega] ADD CONSTRAINT [FK_Bodega_Escuela]
	FOREIGN KEY ([EscuelaID]) REFERENCES [Escuela] ([EscuelaID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Escuela] ADD CONSTRAINT [FK_Escuela_Capital]
	FOREIGN KEY () REFERENCES  () ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Inventario] ADD CONSTRAINT [FK_Inventario_Articulo]
	FOREIGN KEY ([ArticuloID]) REFERENCES [Articulo] ([ArticuloID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Inventario] ADD CONSTRAINT [FK_Inventario_Bodega]
	FOREIGN KEY ([BodegaID]) REFERENCES [Bodega] ([BodegaID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Usuario] ADD CONSTRAINT [FK_Usuario_Rol]
	FOREIGN KEY ([RolID]) REFERENCES [Rol] ([RolID]) ON DELETE No Action ON UPDATE No Action
GO
